version: '3.8'

services:
  # AuditMesh Frontend
  auditmesh-frontend:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_ENABLE_MOCK_DATA=false
      - NEXT_PUBLIC_GATEWAY_URL=http://gateway:3001
      - NEXT_PUBLIC_DETECTOR_URL=http://detector:3002
      - NEXT_PUBLIC_AUDITOR_URL=http://auditor:3003
    depends_on:
      - gateway
      - detector
      - auditor
    networks:
      - auditmesh-network

  # Mock Gateway Service
  gateway:
    image: nginx:alpine
    ports:
      - "3001:80"
    volumes:
      - ./mock-services/gateway:/usr/share/nginx/html
    networks:
      - auditmesh-network

  # Mock Detector Service
  detector:
    image: nginx:alpine
    ports:
      - "3002:80"
    volumes:
      - ./mock-services/detector:/usr/share/nginx/html
    networks:
      - auditmesh-network

  # Mock Auditor Service
  auditor:
    image: nginx:alpine
    ports:
      - "3003:80"
    volumes:
      - ./mock-services/auditor:/usr/share/nginx/html
    networks:
      - auditmesh-network

networks:
  auditmesh-network:
    driver: bridge

volumes:
  auditmesh-data:
